---
title: Сведения о защищенных ветвях
intro: 'Вы можете защитить важные ветви, задав правила защиты ветвей, которые определяют, могут ли участники совместной работы удалять ветвь или выполнять принудительную отправку в нее, и устанавливают требования для любых отправок в ветвь, таких как прохождение проверок состояния или журнал линейной фиксации.'
product: '{% data reusables.gated-features.protected-branches %}'
redirect_from:
  - /articles/about-protected-branches
  - /enterprise/admin/developer-workflow/about-protected-branches-and-required-status-checks
  - /articles/about-branch-restrictions
  - /github/administering-a-repository/about-branch-restrictions
  - /articles/about-required-status-checks
  - /github/administering-a-repository/about-required-status-checks
  - /articles/types-of-required-status-checks
  - /github/administering-a-repository/types-of-required-status-checks
  - /articles/about-required-commit-signing
  - /github/administering-a-repository/about-required-commit-signing
  - /articles/about-required-reviews-for-pull-requests
  - /github/administering-a-repository/about-required-reviews-for-pull-requests
  - /github/administering-a-repository/about-protected-branches
  - /github/administering-a-repository/defining-the-mergeability-of-pull-requests/about-protected-branches
versions:
  fpt: '*'
  ghes: '*'
  ghae: '*'
  ghec: '*'
topics:
  - Repositories
ms.openlocfilehash: 8ec8ac1b43eacc64f44cf785f66a370466bbae8b
ms.sourcegitcommit: bf11c3e08cbb5eab6320e0de35b32ade6d863c03
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/27/2022
ms.locfileid: '148111572'
---
## Сведения о правилах защиты ветвей

Создав правило защиты ветви, вы можете применять определенные рабочие процессы или требования, прежде чем сотрудник может отправить изменения в ветвь в репозитории, включая объединение запроса на вытягивание в ветвь.

По умолчанию каждое правило защиты ветви отключает принудительные отправки в соответствующие ветви и предотвращает удаление соответствующих ветвей. При необходимости эти ограничения можно отключить и включить дополнительные параметры защиты ветви.

{% ifversion bypass-branch-protections %} По умолчанию ограничения правила защиты ветви не применяются к пользователям с разрешениями администратора для репозитория или пользовательских ролей с разрешением "обход защиты ветви". При необходимости вы также можете применить ограничения к администраторам и ролям с разрешением "обход защиты ветви". Дополнительные сведения см. в статье [Управление пользовательскими ролями репозитория для организации](/en/enterprise-cloud@latest/organizations/managing-peoples-access-to-your-organization-with-roles/managing-custom-repository-roles-for-an-organization).
{% else %} По умолчанию ограничения правила защиты ветви не применяются к пользователям с разрешениями администратора в репозитории. При необходимости можно также включить администраторов.{% endif %}

{% data reusables.repositories.branch-rules-example %} Дополнительные сведения о шаблонах имен ветвей см. в статье [Управление правилами защиты ветвей](/github/administering-a-repository/managing-a-branch-protection-rule).

{% data reusables.pull_requests.you-can-auto-merge %}

## Сведения о параметрах защиты ветвей

Для каждого правила защиты ветви можно включить или отключить приведенные ниже параметры.
- [Требовать проверки запросов на вытягивание перед слиянием](#require-pull-request-reviews-before-merging)
- [Требовать проверки состояния перед слиянием](#require-status-checks-before-merging)
- [Требовать устранения разногласий перед слиянием](#require-conversation-resolution-before-merging)
- [Требовать подписанные фиксации](#require-signed-commits)
- [Требовать линейный журнал](#require-linear-history) {% ifversion fpt or ghec %}
- [Требовать очередь слияния](#require-merge-queue) {% endif %} {%- ifversion required-deployments %}
- [Требовать успешного развертывания перед слиянием](#require-deployments-to-succeed-before-merging) {%- endif %} {%- ifversion lock-branch %}
- [Блокировка ветви](#lock-branch) {%- endif %} {% ifversion bypass-branch-protections %}- [Не разрешать обход указанных выше параметров](#do-not-allow-bypassing-the-above-settings){% else %}- [Включение администраторов](#include-administrators){% endif %}
- [Ограничить пользователей, которые могут выполнять отправку в соответствующие ветви](#restrict-who-can-push-to-matching-branches)
- [Разрешить принудительные отправки](#allow-force-pushes)
- [Разрешить удаления](#allow-deletions)

Дополнительные сведения о настройке защиты ветви см. в статье [Управление правилами защиты ветвей](/github/administering-a-repository/managing-a-branch-protection-rule).

### Требовать проверки запросов на вытягивание перед слиянием

{% data reusables.pull_requests.required-reviews-for-prs-summary %}

Если включить необходимые проверки, участники совместной работы могут отправлять изменения только в защищенную ветвь с помощью запроса на вытягивание, утвержденного требуемым количеством рецензентов с разрешениями на запись.

Если пользователь с разрешениями администратора выбирает параметр **Требовать изменения** в проверке, он должен утвердить запрос на вытягивание до его слияния. Если рецензент, требующий изменения для запроса на вытягивание, недоступен, любой пользователь с разрешениями на запись в репозиторий может отклонить блокирующую проверку.

{% data reusables.repositories.review-policy-overlapping-commits %}

Если участник совместной работы пытается выполнить слияние запроса на вытягивание с ожидающими или отклоненными проверками в защищенную ветвь, он получит сообщение об ошибке.

```shell
remote: error: GH006: Protected branch update failed for refs/heads/main.
remote: error: Changes have been requested.
```

При необходимости при отправке фиксаций можно отклонять устаревшие утверждения запросов на вытягивание. Если кто-либо отправляет фиксацию, которая изменяет код на утвержденный запрос на вытягивание, утверждение будет отклонено, и запрос на вытягивание будет невозможно объединить. Это не относится к случаям, когда участник совместной работы отправляет фиксации, не изменяющие код, например, слияние базовой ветви в ветвь запроса на вытягивание. Сведения о базовой ветви см. в статье [Сведения о запросах на вытягивание](/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests).

При необходимости можно ограничить возможность отклонять проверки запросов на вытягивание определенными людьми или командами. Дополнительные сведения см. в разделе [Пропуск проверки запроса на вытягивание](/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/dismissing-a-pull-request-review).

При необходимости можно требовать проведение проверок от владельцев кода. В этом случае любой запрос на вытягивание, влияющий на код, должен быть утвержден этим владельцем кода, прежде чем запрос на вытягивание можно будет объединить в защищенную ветвь.

{% ifversion last-pusher-require-approval %} При необходимости вы можете потребовать утверждения от кого-то, кроме последнего пользователя для отправки в ветвь, прежде чем можно будет объединить запрос на вытягивание. Это гарантирует, что несколько пользователей увидят запросы на вытягивание в конечном состоянии, прежде чем они будут объединены в защищенную ветвь. Если вы включите эту функцию, последнему пользователю, который отправляет свои изменения, потребуется утверждение независимо от требуемой защиты ветви утверждений. Пользователи, которые уже рассмотрели запрос на вытягивание, могут повторно принять его после последней отправки в соответствии с этим требованием.
{% endif %}

### Требовать проверки состояния перед слиянием

Обязательные проверки состояния обеспечивают выполнение всех необходимых тестов непрерывной интеграции перед тем, как соавторы смогут вносить изменения в защищенную ветвь. Обязательные проверки состояния могут быть проверками или состояниями. Дополнительные сведения см. в разделе [Сведения о проверках состояния](/github/collaborating-with-issues-and-pull-requests/about-status-checks).

Перед включением обязательных проверок состояния необходимо настроить репозиторий для использования API состояния фиксации. Дополнительные сведения см. в разделе "[Состояния фиксации](/rest/commits/statuses)" документации по REST API.

После включения необходимых проверок состояния все они должны быть выполнены, после чего участники совместной работы смогут объединять изменения в защищенную ветвь. После прохождения всех необходимых проверок состояния все фиксации должны быть либо отправлены в другую ветвь, а затем объединены, либо или отправлены непосредственно в защищенную ветвь.

Любой пользователь или интеграция с разрешениями на запись в репозиторий может задать состояние любой проверки состояния в репозитории{% ifversion fpt or ghes > 3.3 или ghae > 3.3 или ghec %}, но в некоторых случаях может потребоваться принять проверку состояния только из определенного {% data variables.product.prodname_github_app %}. При добавлении требуемой проверки состояния можно выбрать приложение, которое недавно задало эту проверку в качестве ожидаемого источника обновлений состояния.{% endif %} Если состояние задано любым другим человеком или интеграцией, слияние будет запрещено. Если выбрать вариант "Любой источник", по-прежнему можно вручную проверять автора каждого состояния, указанного в поле слияния.

Вы можете настроить требуемые проверки состояния как "Нестрогие" или "Строгие". Выбранный тип требуемой проверки состояния определяет, должна ли ваша ветвь быть обновлена в соответствии с базовой ветвью перед слиянием.

| Тип требуемой проверки состояния | Параметр | Требования к слиянию | Рекомендации |
| --- | --- | --- | --- |
| **Strict** | Установлен флажок **Требовать актуальность ветвей перед слиянием**. | Перед слиянием ветвь **должна** быть обновлена в соответствии с базовой ветвью. | Это поведение по умолчанию для требуемых проверок состояния. Могут потребоваться дополнительные сборки, так как вам будет необходимо обновлять главную ветвь после того, как другие участники совместной работы объединят запросы на вытягивание в защищенную базовую ветвь.|
| **Нестрогая** | Флажок **Требовать актуальность ветвей перед слиянием** **не** установлен. | Перед слиянием ветвь **не должна** быть обновлена в соответствии с базовой ветвью. | У вас будет меньше требуемых сборок, так как вам не нужно будет обновлять главную ветвь после того, как другие участники совместной работы объединят запросы на вытягивание. При наличии изменений, несовместимых с главной ветвью, проверки состояния могут завершиться ошибкой после слияния ветви. |
| **Отключено** | Флажок **Требовать прохождения проверок состояния перед слиянием** **не** установлен. | Ветвь не имеет ограничений на слияние. | Если требуемые проверки состояния не включены, участники совместной работы могут объединить ветвь в любое время независимо от того, обновлена ли она в соответствии с базовой ветвью. Это повышает вероятность возникновения несовместимых изменений.

Сведения об устранении неполадок см. в статье [Устранение неполадок, связанных с требуемыми проверками состояния](/github/administering-a-repository/troubleshooting-required-status-checks).

### Требовать устранения разногласий перед слиянием

Требует, чтобы все комментарии к запросу на вытягивание были разрешены, прежде чем его можно будет объединить с защищенной ветвью. Это гарантирует, что перед слиянием все комментарии будут разрешены или подтверждены.

### Требование подписания фиксаций

При включении обязательного подписывания фиксации в ветви участники совместной работы {% ifversion fpt or ghec %}и боты{% endif %} могут отправлять в ветвь только подписанные и проверенные фиксации. Дополнительные сведения см. в разделе [Сведения о проверке сигнатуры фиксации](/articles/about-commit-signature-verification).

{% note %}

{% ifversion fpt or ghec %} **Примечания.** 

* Если включен режим бдительности, указывающий, что фиксации всегда будут подписаны, все фиксации, которые {% data variables.product.prodname_dotcom %} идентифицирует как "Частично проверенные", разрешены в ветвях, требующих подписанных фиксаций. Дополнительные сведения о режиме бдительности см. в статье [Отображение состояний проверки для всех фиксаций](/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).
* Если участник совместной работы отправляет неподписанную фиксацию в ветвь, требующую подписания фиксации, ему потребуется переместить изменения из одной ветви в другую, чтобы включить проверенную подпись, а затем принудительно отправить переписанную фиксацию в ветвь.

{% else %} **Примечание.** Если участник совместной работы отправляет неподписанную фиксацию в ветвь, требующую подписания фиксации, ему потребуется переместить изменения из одной ветви в другую, чтобы включить проверенную подпись, а затем принудительно отправить переписанную фиксацию в ветвь.
{% endif %}

{% endnote %}

Вы всегда можете отправлять локальные фиксации в ветвь, если они подписаны и проверены. {% ifversion fpt or ghec %}Вы можете также объединить подписанные и проверенные фиксации в ветвь с помощью запроса на вытягивание в {% data variables.product.product_name %}. Однако вы не можете объединить запрос на вытягивание в ветвь на {% data variables.product.product_name %}, если вы не являетесь автором запроса на вытягивание. {% else %} Однако вы не можете объединить запросы на вытягивание в ветвь на {% data variables.product.product_name %}. {% endif %} Вы можете {% ifversion fpt or ghec %}squash и {% endif %}объединить запросы на вытягивание локально. Дополнительные сведения см. в статье [Локальное извлечение запросов на вытягивание](/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally).

{% ifversion fpt or ghec %} Дополнительные сведения о методах слияния см. в статье [Сведения о методах слияния в {% data variables.product.prodname_dotcom %}](/github/administering-a-repository/about-merge-methods-on-github).{% endif %}

### Требовать линейный журнал

Если применяется линейный журнал фиксаций, участники совместной работы не смогут отправлять фиксации слияния в ветвь. Это означает, что все запросы на вытягивание, объединенные в защищенную ветвь, должны использовать слияние со сжатием или слияние с перемещением из одной ветви в другую. Используя строго линейный журнал фиксаций, команды могут быстрее отменять изменения. Дополнительные сведения о методах слияния см. в статье [Сведения о слияниях запросов на вытягивание](/github/collaborating-with-issues-and-pull-requests/about-pull-request-merges).

Прежде чем требовать линейный журнал фиксаций, репозиторий должен разрешить слияние со сжатием или слияние с перемещением из одной ветви в другую. Дополнительные сведения см. в разделе [Настройка объединения запросов на вытягивание](/github/administering-a-repository/configuring-pull-request-merges).

{% ifversion fpt or ghec %}
### Требовать очередь слияния

{% data reusables.pull_requests.merge-queue-beta %} {% data reusables.pull_requests.merge-queue-overview %}
 
{% data reusables.pull_requests.merge-queue-merging-method %} {% data reusables.pull_requests.merge-queue-references %}

{% endif %}

### Требовать успешного развертывания перед слиянием

Вы можете потребовать успешного развертывания изменений в определенные среды, прежде чем можно будет выполнить слияние ветви. Например, это правило можно использовать для успешного развертывания изменений в промежуточную среду перед слиянием изменений в ветвь по умолчанию.

{% ifversion lock-branch %}
### Блокировка ветви

Блокировка ветви гарантирует отсутствие фиксаций в ветви. По умолчанию вилку репозитория не поддерживает синхронизацию из вышестоящего репозитория. Вы можете включить **параметр Разрешить синхронизацию вилок** для извлечения изменений из вышестоящего репозитория, не позволяя вносить другие изменения в ветвь вилки.
{% endif %}

{% ifversion bypass-branch-protections %}### Не разрешать обход указанных выше параметров{% else %}
### Включить администраторов{% endif %}

{% ifversion bypass-branch-protections %} По умолчанию ограничения правила защиты ветви не применяются к пользователям с разрешениями администратора для репозитория или пользовательских ролей с разрешением "обход защиты ветви" в репозитории. 

Вы также можете включить этот параметр для применения ограничений к администраторам и ролям с разрешением "обход защиты ветви".  Дополнительные сведения см. в статье [Управление пользовательскими ролями репозитория для организации](/en/enterprise-cloud@latest/organizations/managing-peoples-access-to-your-organization-with-roles/managing-custom-repository-roles-for-an-organization).
{% else %} По умолчанию правила защищенных ветвей не применяются к пользователям с разрешениями администратора в репозитории. Этот параметр можно использовать для включения администраторов в правила защищенных ветвей.{% endif %}

### Ограничить пользователей, которые могут выполнять отправку в соответствующие ветви

{% ifversion fpt or ghec %} Вы можете включить ограничения для ветвей, если ваш репозиторий принадлежит организации, использующей {% data variables.product.prodname_team %} или {% data variables.product.prodname_ghe_cloud %}.
{% endif %}

При включении ограничений для ветвей выполнять отправку в защищенную ветвь могут только пользователи, команды или приложения, которым предоставлено соответствующее разрешение. Просматривать и изменять пользователей, команды или приложения с правами на отправку в защищенную ветвь можно в параметрах защищенной ветви. Если требуются проверки состояния, пользователям, командам и приложениям, имеющим разрешение на отправку в защищенную ветвь, по-прежнему будет запрещено выполнять слияние в ветвь при сбое требуемых проверок. Пользователям, командам и приложениям, имеющим разрешение на отправку в защищенную ветвь, по-прежнему потребуется создать запрос на вытягивание, если требуются запросы на вытягивание.

{% ifversion restrict-pushes-create-branch %} При необходимости можно применить те же ограничения к созданию ветвей, которые соответствуют правилу. Например, если вы создаете правило, которое позволяет выполнять отправки в ветви, содержащие слово `release`, только определенной команде, только члены этой команды смогут создать новую ветвь, содержащую слово `release`.
{% endif %}

Вы можете предоставить права на отправку в защищенную ветвь или предоставить разрешение на создание соответствующей ветви только пользователям, командам или установленным {% data variables.product.prodname_github_apps %} с доступом на запись в репозиторий. Люди и приложения с разрешениями администратора для репозитория всегда могут отправить в защищенную ветвь{% ifversion restrict-pushes-create-branch %} или создать соответствующую ветвь{% endif %}.

### Разрешить принудительные отправки

{% ifversion fpt or ghec or ghes > 3.3 or ghae > 3.3 %} По умолчанию {% data variables.product.product_name %} блокирует принудительные отправки во все защищенные ветви. При включении принудительной отправки в защищенную ветвь можно выбрать одну из двух групп, которые поддерживают принудительную отправку:

1. Разрешить всем, у кого есть по крайней мере разрешения на запись в репозиторий, включая администраторов, выполнять принудительную отправку в ветвь.
1. Разрешить выполнять принудительную отправку в ветвь только определенным пользователям или командам.

Если кто-то выполняет принудительную отправку в ветвь, такая отправка может перезаписать фиксации, являющиеся основой работы других участников совместной работы. У людей могут возникнуть конфликты слияния или появиться поврежденные запросы на вытягивание.

{% else %} По умолчанию {% data variables.product.product_name %}блокирует принудительные отправки во все защищенные ветви. При включении принудительной отправки в защищенную ветвь выполнять такой вид отправки может любой пользователь, имеющий по крайней мере разрешения на запись в репозиторий. Это могут делать и пользователи с разрешениями администратора. Если кто-то выполняет принудительную отправку в ветвь, такая отправка может перезаписать фиксации, являющиеся основой работы других участников совместной работы. У людей могут возникнуть конфликты слияния или появиться поврежденные запросы на вытягивание.
{% endif %}

Включение принудительных отправок не переопределит другие правила защиты ветвей. Например, если ветви требуется линейный журнал фиксаций, принудительно отправлять фиксации слияния в эту ветвь невозможно.

{% ifversion ghes or ghae %}Вы не можете включить принудительные отправки в защищенную ветвь, если администратор сайта заблокировал принудительные отправки во все ветви в вашем репозитории. Дополнительные сведения см. в статье [Блокировка принудительных отправок в репозитории, принадлежащие личной учетной записи или организации](/enterprise/admin/developer-workflow/blocking-force-pushes-to-repositories-owned-by-a-user-account-or-organization).

Если администратор сайта заблокировал принудительные отправки только в ветвь по умолчанию, вы по-прежнему можете включить принудительные отправки в любую другую защищенную ветвь.{% endif %}

### Разрешить удаления

По умолчанию удалить защищенную ветвь невозможно. Если включено удаление защищенной ветви, удалить ее может любой пользователь, имеющий по крайней мере разрешения на запись в репозиторий.
