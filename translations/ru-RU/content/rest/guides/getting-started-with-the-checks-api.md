---
title: Начало работы с API проверок
intro: 'API проверки запусков позволяет создавать приложения GitHub, которые выполняют эффективные проверки для любых изменений кода в репозитории. Вы можете создавать приложения, которые выполняют непрерывную интеграцию, структурирование кода или службы сканирования кода и предоставляют подробные отзывы о фиксациях.'
versions:
  fpt: '*'
  ghes: '*'
  ghae: '*'
  ghec: '*'
topics:
  - API
shortTitle: Get started - Checks API
ms.openlocfilehash: 6d98940d9cf4f4fd534034e142aa3d86a0900406
ms.sourcegitcommit: 478f2931167988096ae6478a257f492ecaa11794
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/09/2022
ms.locfileid: '147710246'
---
## Общие сведения

Вместо бинарных состояний сборки (выполнено или не выполнено) приложения GitHub могут сообщать расширенные состояния, добавлять к строкам кода заметки с подробными сведениями и повторно проводить тесты. Функциональные возможности API проверок доступны исключительно приложениям GitHub.

Пример использования API проверок с {% data variables.product.prodname_github_app %} см. в разделе [Создание тестов непрерывной интеграции с помощью API проверок](/apps/quickstart-guides/creating-ci-tests-with-the-checks-api/).

## Сведения о наборах проверок

Когда кто-нибудь отправляет код в репозиторий, GitHub создает набор проверок для последней фиксации. Набор проверок — это коллекция [запусков проверок](/rest/reference/checks#check-runs), созданных одним приложением GitHub для определенной фиксации. Набор проверок позволяет получить общее заключение о состоянии выполнения проверок, входящих в состав набора.

![Рабочий процесс набора проверок](/assets/images/check_suites.png)

Набор проверок сообщает значение `conclusion` выполнения проверки с наивысшим приоритетом из всех значений `conclusion` набора проверок. Например, если для трех выполнений проверок получены заключения `timed_out`, `success` и `neutral`, заключением для набора проверок будет `timed_out`.

По умолчанию GitHub автоматически создает набор проверок при отправке кода в репозиторий. В рамках этого процесса по умолчанию событие `check_suite` (с действием `requested`) отправляется всем приложениям GitHub с разрешением `checks:write`. Когда приложение GitHub получает событие `check_suite`, оно может создать новые выполнения проверок для последней фиксации. GitHub автоматически добавляет новые выполнения проверок в соответствующий [набор проверок](/rest/reference/checks#check-suites) с учетом репозитория и SHA.

Если вы не хотите использовать автоматический процесс по умолчанию, то можете управлять созданием наборов проверок. Чтобы изменить параметры по умолчанию для создания наборов проверок, используйте конечную точку [обновления параметров наборов проверок для репозитория](/rest/reference/checks#update-repository-preferences-for-check-suites). Все изменения параметров автоматического процесса записываются в журнал аудита репозитория. Если вы отключили автоматический процесс, набор проверок можно создать с помощью конечной точки [создания набора проверок](/rest/reference/checks#create-a-check-suite). Далее следует использовать конечную точку [создания выполнения проверки](/rest/reference/checks#create-a-check-run) для предоставления отзывов о фиксации.

{% data reusables.apps.checks-availability %}

Чтобы использовать API наборов проверок, приложение GitHub должно иметь разрешение `checks:write` и может подписаться на веб-перехватчик [check_suite](/webhooks/event-payloads/#check_suite).

{% data reusables.shortdesc.authenticating_github_app %}

## Сведения о выполнениях проверок

Выполнение проверки — это отдельный тест, входящий в состав набора проверок. Каждое выполнение имеет состояние и заключение.

![Рабочий процесс выполнения проверки](/assets/images/check_runs.png)

Если выполнение проверки находится в незавершенном состоянии дольше 14 дней, его значение `conclusion` становится равным `stale` и выполнение отображается на {% data variables.product.prodname_dotcom %} как устаревшее со значком {% octicon "issue-reopened" aria-label="The issue-reopened icon" %}. Выполнения проверок могут помечаться как `stale` только на {% data variables.product.prodname_dotcom %}. Дополнительные сведения о возможных заключениях для выполнения проверки см. в [описании параметра `conclusion`](/rest/reference/checks#create-a-check-run--parameters).

Как только вы получите веб-перехватчик [`check_suite`](/webhooks/event-payloads/#check_suite), вы можете создать выполнение проверки, даже если проверка не завершена. Вы можете изменить состояние (`status`) выполнения проверки после его завершения на значение `queued`, `in_progress` или `completed`, а также обновлять `output` по мере получения дополнительных сведений. Выполнение проверки может содержать метки времени, ссылку на дополнительные сведения на внешнем сайте, подробные заметки для определенных строк кода и сведения о проведенном анализе.

![Заметки выполнения проверки](/assets/images/check_run_annotations.png)

Проверку также можно выполнить повторно вручную в пользовательском интерфейсе GitHub. Дополнительные сведения см. в разделе [Сведения о проверках состояния](/articles/about-status-checks#checks). В этом случае приложение GitHub, создавшее выполнение проверки, получит веб-перехватчик [`check_run`](/webhooks/event-payloads/#check_run), запрашивающий новое выполнение проверки. Если вы создаете выполнение проверки без набора проверок, GitHub создает набор проверок автоматически.

{% data reusables.apps.checks-availability %}

Чтобы использовать API выполнений проверок, приложение GitHub должно иметь разрешение `checks:write` и может подписаться на веб-перехватчик [check_run](/webhooks/event-payloads#check_run).

## Выполнения проверок и запрошенные действия

При настройке выполнения проверки с запрошенными действиями (не путать с {% data variables.product.prodname_actions %}) в представлении запроса на вытягивание на {% data variables.product.prodname_dotcom %} можно отобразить кнопку, с помощью которой пользователь может запросить у {% data variables.product.prodname_github_app %} выполнение дополнительных задач.

Например, приложение для анализа кода может использовать запрошенные действия с целью отображения в запросе на вытягивание кнопки для автоматического исправления обнаруженных синтаксических ошибок.

Чтобы создать кнопку для запроса дополнительных действий в приложении, используйте [объект `actions`](/rest/reference/checks#create-a-check-run--parameters) при [создании выполнения проверки](/rest/reference/checks/#create-a-check-run). Например, приведенный ниже объект `actions` отображает в запросе на вытягивание кнопку с меткой Fix this (Исправить). Кнопка появляется после завершения выполнения проверки.

   ```json
  "actions": [{
      "label": "Fix this",
      "description": "Let us fix that for you",
      "identifier": "fix_errors"
    }]
  ```

  ![Кнопка для запрошенного действия выполнения проверки](/assets/images/github-apps/github_apps_checks_fix_this_button.png)

Когда пользователь нажимает эту кнопку, {% data variables.product.prodname_dotcom %} отправляет в приложение [веб-перехватчик `check_run.requested_action`](/webhooks/event-payloads/#check_run). Когда приложение получает событие веб-перехватчика `check_run.requested_action`, оно может найти ключ `requested_action.identifier` в полезных данных веб-перехватчика, чтобы определить, какая кнопка была нажата, и выполнить запрошенную задачу.

Подробный пример настройки запрошенных действий с помощью API проверок см. в разделе [Создание тестов непрерывной интеграции с помощью API проверок](/apps/quickstart-guides/creating-ci-tests-with-the-checks-api/#part-2-creating-the-octo-rubocop-ci-test).

{% ifversion fpt or ghec %}
## Хранение данных о проверках

{% data reusables.pull_requests.retention-checks-data %} {% endif %}
