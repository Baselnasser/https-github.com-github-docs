---
title: Выполнение полного перестроения контейнера
intro: 'Если у вас недостаточно места на диске или вы хотите убедиться, что конфигурация контейнера разработки будет работать в новых пространствах кода, можно выполнить полное перестроение контейнера.'
versions:
  fpt: '*'
  ghec: '*'
type: reference
topics:
  - Codespaces
shortTitle: Full rebuilds
ms.openlocfilehash: f844d5f92073adf01c3b1a1100e6fe1912b2d7ad
ms.sourcegitcommit: 3ff64a8c8cf70e868c10105aa6bbf6cd4f78e4d3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2022
ms.locfileid: '148180851'
---
## Сведения о перестроении контейнера

При работе в codespace среда разработки представляет собой контейнер Docker, который выполняется на виртуальной машине. Если вы вносите изменения в конфигурацию контейнера разработки из codespace и хотите применить эти изменения к текущему codespace, необходимо перестроить контейнер.

По умолчанию при перестроении контейнера {% data variables.product.prodname_github_codespaces %} ускорит процесс сборки, повторно используя кэшированные образы из предыдущих сборок контейнера. Обычно это самый быстрый способ реализовать изменения в конфигурации контейнера разработки по следующим причинам.
- {% data variables.product.prodname_github_codespaces %} может повторно использовать образы в кэше, а не удалять их из реестров контейнеров.
- Части конфигурации контейнера разработки, определяющие способ сборки контейнера, такие как функции контейнера разработки и инструкции Dockerfile, возможно, уже реализованы на уровнях образов в кэше, поэтому вам не придется ждать повторного запуска этих процессов. (Однако команды в конфигурации, которые выполняются после сборки контейнера, например `onCreateCommand`, будут выполняться снова.)

Иногда может потребоваться выполнить полную перестройку контейнера. При полном перестроении {% data variables.product.prodname_github_codespaces %} очищает все контейнеры, образы и тома Docker из кэша, а затем перестраивает контейнер с новыми извлеченными образами. Вся настройка, определенная в конфигурации, будет выполняться снова, создавая новые слои образов. Вы можете выполнить полную перестройку после многих итераций перестроения контейнера с кэшируемыми образами в таких ситуациях, как показано ниже.

- Необходимо убедиться, что настройка, определенная в конфигурации, не зависит от кэшированных образов и будет выполняться по мере необходимости, когда кто-то создает новое пространство кода на основе конфигурации. Например, зависимость может быть удалена из базового образа с момента последнего извлечения в codespace.
- Вы хотите освободить дисковое пространство, используемое кэшем, например, если у вас мало места на диске или вы хотите свести к минимуму расходы на хранилище. Кэш образов может использовать значительный объем дискового пространства, если вы несколько раз меняли базовый образ, если вы внесли большое количество итеративных изменений в конфигурацию или если вы используете несколько контейнеров с Docker Compose.

## Выполнение полного перестроения

Полное перестроение можно выполнить в {% data variables.product.prodname_vscode %}.

{% data reusables.codespaces.command-pallette %}
1. Начните вводить "Перестроение" и выберите **Codespaces: Полный контейнер перестроения**.

   ![Снимок экрана: команда "Полный перестроение контейнера" в элементе Command Pallette](/assets/images/help/codespaces/codespaces-rebuild-full.png)

## Сохранение данных при полном перестроении

Все файлы и папки, содержащиеся в каталоге `/workspaces` codespace, всегда сохраняются при перестроении. Вам не нужно изменять параметры или добавлять конфигурацию, чтобы сохранить содержимое этого каталога при полной перестройке.

Если вы хотите сохранить файлы за пределами `/workspaces` каталога при полном перестроении, можно создать в нужном расположении в контейнере символьную ссылку (символьную ссылку) на постоянный каталог. Например, в каталоге `/workspaces/.devcontainer` можно создать каталог `config`, который будет сохранен при перестроении. Затем вы можете связать символьной ссылкой каталог `config` и его содержимое как `postCreateCommand` в файле `devcontainer.json`.

```json  
{
    "image": "mcr.microsoft.com/vscode/devcontainers/base:alpine",
    "postCreateCommand": ".devcontainer/postCreate.sh"
}
```

В приведенном ниже примере файла `postCreate.sh` содержимое каталога `config` связано символической ссылкой с домашним каталогом.

```bash
#!/bin/bash
ln -sf $PWD/.devcontainer/config $HOME/config && set +x
```

## Дополнительные материалы
- [Общие сведения о контейнерах разработки](/codespaces/setting-up-your-project-for-codespaces/introduction-to-dev-containers)
